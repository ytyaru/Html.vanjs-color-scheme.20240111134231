# アプリ配色の最適化

## 目的

　人が液晶ディスプレイを閲覧・操作するときの配色を最適化したい。

## 方針

* その人、その時、その場に応じて最適化される
* パーソナライズされたそれらの情報は個人情報としてセキュアに扱う
* ユーザの操作は必要最小限である
* ユーザはいつでも思い通りに変更できる

## 方法

* 自動設定する時間
    * 太陽高度
    * 定時
    * 固定
* 自動設定の是非とタイミング
    * 起動時
    * 起動中

## 宣伝 4E（4つのやさしさ）

* 私にやさしい（設定）             エゴイスティック egoistic   自分本位,自己中心
* 人にやさしい（目、眠り）         エルゴノミック   ergonomics 人間工学
* 財布にやさしい（電気代）         エコノミー       economy    
* 地球にやさしい（CO2、放射能汚染）エコロジー       ecology    

　夜モードはエコである。エゴエルエコエコ ego-er-eco-eco  4e

　私,人,金,場の4つにやさしい。
　自分本位であることは結果的に全人類かつ地球のためにもなる。これを実現するための理論と実装をめざす。
　アプリ配色最適化理論において4Eは成立する。
　夜に暗い配色にすれば目にやさしく健康にやさしく電気代が抑えられ省エネになりCO2や放射能汚染を軽減できる。それは未来の子孫たちの生存環境を守ることにつながる。ユーザが自分の健康や経済を守るために配色設定することは、生物が生存できる環境を守ることにもつながる。

## 目標

## 詳細

### 配色理論

　ディスプレイ配色（光の強さ）の最適化は、それを閲覧する環境光の強さに比例して変化させることで実現する。すなわち環境光が強いときはディスプレイも強く発光させ、環境光が弱いときはディスプレイも弱く発光させる。これがディスプレイ配色最適化理論の骨子である。

　なぜ環境光に比例させるか。それは見やすさと健康を考慮している。
　ディスプレイは環境光に比例して発光させると見やすい。人の目は環境光の強弱に慣れた状態である。このとき、それに反比例する光の強さがあると、その部分は見えにくくなってしまう。つまり青空の下でディスプレイを閲覧するときは光を強くし、日没後の夜に閲覧するときは光を弱くすると見やすくなる。

　夜はブルーライトも考慮すべきである。人はブルーライトを浴びると眠りにくくなる。光を浴びることが眠りにくさの原因なので、そもそも閲覧しないことが望ましい。それでも閲覧したいとき、なるだけ影響を軽微にするためには、光を弱くすることだ。特にブルーライトは減らすことが重要である。

　ディスプレイの閲覧は人の目に悪い。なるだけ影響を軽微にするには発光を弱めることが必要だ。しかし閲覧しにくい条件下で無理して見ても逆効果である。そこで一定の環境光の強さに応じて配色を決定するのが最善である。

　最適化は人によって異なるため個人設定できることが望ましい。ただし太陽高度の算出には座標が必要であり、それは個人情報として秘匿すべきである。この取扱については要注意。たとえばLocalStorageやIndexedDBに保存するとXSS攻撃によって盗まれる恐れがある。保存するならブラウザ管理外のローカルファイルに保存すべき。しかしユーザ操作なしにそれを参照することはできないため、ユーザに毎回パスを指定させる負担がかかる。それは配色の自動化よりも重い負担のため、費用対効果が釣り合わない。よってブラウザ・アプリではなくネイティブ・アプリで実装すべき。その具体的な実装方法や開発言語、必要ライブラリなどは損座するのか、あるなら何か、未調査である。

### 自動設定する時間

#### 太陽高度

```
```

#### 定時

```
[夜] ☑ 実行する
 昼
[19:00]〜[07:00]   [ 1]分刻み
 15:00    03:00     15
 21:00    09:00     30
                    60
☑ 起動時 ☑ 柔 ☐ 青
☑ 起動中 ☑ 柔 ☐ 青
```

```
[昼] ☐ 実行する
 夜
[09:00]〜[15:00]   [ 1]分刻み
 06:00    13:00     15
 12:00    19:00     30
                    60
☑ 起動時 ☑ 柔 ☑ 青
☑ 起動中 ☑ 柔 ☑ 青
```
```
夜 ☑ 実行する                  昼 ☐ 実行する
[19:00]〜[07:00]   [ 1]分刻み  [09:00]〜[15:00]   [ 1]分刻み
 15:00    03:00     15          06:00    13:00     15
 21:00    09:00     30          12:00    19:00     30
                    60                             60
☑ 起動時 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動時 ☐ 微調整(☑ 柔 ☑ 青)
☑ 起動中 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動中 ☐ 微調整(☑ 柔 ☑ 青)
```

# デフォルト配色

```
[夜]
 昼
夜 ☑ 柔 ☐ 青
昼 ☑ 柔 ☑ 青
```

　最初に文書を読んだ時の配色設定。これは目にやさしい黒にすべき。

```css
body {
  color: #fff;
  background-color: #000;
}
```

　後に個人設定を読み込めたタイミングで配色設定する。

　最初の配色設定はHTMLに固定で書き記す必要がある。そこでHTMLファイルをまるごとダウンロードできるようにしたい。

```html
<html>
<head>
<style>
body {
  color: #fff;
  background-color: #000;
}
</style>
</head>
<body>
</body>
</html>
```
```
デフォルト[夜▼] 夜(☑ 柔 ☐ 青)
           昼    昼(☑ 柔 ☑ 青)

定時
           夜 ☑ 実行する                  昼 ☐ 実行する
    [19:00]〜[07:00] ([ 1]分刻み)  [09:00]〜[15:00] ([ 1]分刻み)
     15:00    03:00    15           06:00    13:00    15
     21:00    09:00    30           12:00    19:00    30
                       60                             60
    ☑ 起動時 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動時 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ 起動中 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動中 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)   ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)
```

* デフォルトの配色を決める（[夜|昼]モード、各値時の[柔|青]）
* 年中[明|暗]い時間帯には起動[時|中]自動的に[昼|夜]モードにする

　デフォルトは夜で固定にする。これを変動させることはファイル書き換えになるので不可能。ただし柔青は設定可能。

　起動中：その時間になったらそのモードに自動設定する。`setTimeout()`で実行する。念の為次回の実行予約もする。再帰で。
　UI固定：その時間になったらそのモードに自動設定し、UI操作による変更さえも禁ずる。微調整さえも固定するか否かは設定できる。

```
デフォルト[夜▼] 夜(☑ 柔 ☐ 青)
           昼    昼(☑ 柔 ☑ 青)

太陽高度
    地点 [GPS] [北海道 札幌市▼] [GoogleMap]
         [緯度, 経度][自宅▼]
                      [＋]
         [00.0]度（sunrise判定する太陽高度（周辺の地形を考慮。地表より太陽最下点が何度高いか。障害物を回避する高度。0〜90））
    定時
        夜 ☑ 実行する                  昼 ☐ 実行する
        nn:nn〜nn:nn                   nn:nn〜nn:nn
    ☑ 起動時 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動時 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ 起動中 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動中 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)   ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)

定時
           夜 ☑ 実行する                  昼 ☐ 実行する
    [19:00]〜[07:00] ([ 1]分刻み)  [09:00]〜[15:00] ([ 1]分刻み)
     15:00    03:00    15           06:00    13:00    15
     21:00    09:00    30           12:00    19:00    30
                       60                             60
    ☑ 起動時 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動時 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ 起動中 ☐ 微調整(☑ 柔 ☐ 青)   ☑ 起動中 ☐ 微調整(☑ 柔 ☑ 青)
    ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)   ☑ UI固定 ☐ 微調整(☐ 柔 ☐ 青)
```

　個人情報がセキュアに保てる時、太陽高度による定時実行の設定が可能になる。

　地点の入力は５つある。GPS、固定CSV中選択、GoogleMap、テキスト入力、保存値テキスト入力。
　アプリ起動時における優先度は保存値（上から）、テキスト入力値である。他の方法はそれぞれユーザ操作を経て最終的にテキスト入力値される。

* https://keisan.casio.jp/exec/system/1176871247

　保存値はタイトル、緯度、経度、順序の４つ。タイトルは任意テキスト８字「自宅、学校、会社、外出先、県庁、会場、例の所、あの人の家」の８候補ある。

